package br.com.eccomerce.gui;

import java.time.LocalDate;
import java.util.Date;
import java.util.List;
import java.util.Scanner;

import br.com.eccomerce.dao.ProdutoDAO;
import br.com.eccomerce.dao.ClienteDAO;
import br.com.eccomerce.dao.PedidoDAO;
import br.com.eccomerce.dao.ProdutoPedidoDAO;
import br.com.eccomerce.model.Cliente;
import br.com.eccomerce.model.Produto;
import br.com.eccomerce.model.Pedido;
import br.com.eccomerce.model.ProdutoPedido;
import br.com.eccomerce.model.Venda;

public class TerminalGUI {
	public static void menu() {
		
		Scanner leitor = new Scanner(System.in);
		
		boolean continuar = true;
		while(continuar) {
			int escolha;
			System.out.print("\n--- MENU --- \n" 
								+ "1. PRODUTOS\n"
								+ "2. PEDIDOS\n"
								+ "3. CLIENTES\n"
								+ "4. SAIR\n"
								+ "Sua escolha: ");
			escolha = leitor.nextInt();
			System.out.println();
			
			switch(escolha) {
			case 1:
				menuProduto();
				break;
			case 2:
				menuPedido();
				break;
			case 3: 
				menuCliente();
				break;
			case 4:
				System.out.println("Saindo...");
				continuar = false;
				break;
			default:
				System.out.println("Escolha invalida");
				break;
			}
		}
	}
	
	private static void menuProduto() {
		Scanner leitor = new Scanner(System.in);
		
		boolean continuar = true;
		while(continuar) {
			int escolha;
			System.out.print("\n--- MENU PRODUTO --- \n" 
								+ "1. LISTAR PRODUTOS\n"
								+ "2. ADICIONAR PRODUTO\n"
								+ "3. EXCLUIR PRODUTO\n"
								+ "4. MODIFICAR PRODUTO\n"
								+ "5. PROCURAR PRODUTO PELO NOME\n"
								+ "6. PROCURAR PRODUTO PELO PREÇO\n"
								+ "7. VOLTAR\n"
								+ "Sua escolha: ");
			escolha = leitor.nextInt();
			System.out.println();
			
			switch(escolha) {
			case 1:
				listarProduto();
				break;
			case 2:
				adicionarProduto();
				break;
			case 3: 
				excluirProduto();
				break;
			case 4:
				modificarProduto();
				break;
			case 5:
				procurarNomeProduto();
				break;
			case 6:
				procurarPrecoProduto();
				break;
			case 7:
				System.out.println("Voltando...");
				continuar = false;
				break;
			default:
				System.out.println("Escolha invalida");
				break;
			}
		}
	}
	
	private static void menuPedido() {
		Scanner leitor = new Scanner(System.in);
		
		boolean continuar = true;
		while(continuar) {
			int escolha;
			System.out.print("\n--- MENU PEDIDO --- \n" 
								+ "1. LISTAR PEDIDOS\n"
								+ "2. ADICIONAR PEDIDO\n"
								+ "3. EXCLUIR PEDIDO\n"
								+ "4. MODIFICAR PEDIDO\n"
								+ "5. VOLTAR\n"
								+ "Sua escolha: ");
			escolha = leitor.nextInt();
			System.out.println();
			
			switch(escolha) {
			case 1:
				listarPedido();
				break;
			case 2:
				adicionarPeidido();
				break;
			case 3: 
				excluirPeidido();
				break;
			case 4:
				modificarPedido();
				break;
			case 5:
				System.out.println("Voltando...");
				continuar = false;
				break;
			default:
				System.out.println("Escolha invalida");
				break;
			}
		}
	}

	private static void menuCliente() {
		Scanner leitor = new Scanner(System.in);
		
		boolean continuar = true;
		while(continuar) {
			int escolha;
			System.out.print("\n--- MENU CLIENTE --- \n" 
								+ "1. LISTAR CLIENTE\n"
								+ "2. ADICIONAR CLIENTE\n"
								+ "3. EXCLUIR CLIENTE\n"
								+ "4. MODIFICAR CLIENTE\n"
								+ "5. VOLTAR\n"
								+ "Sua escolha: ");
			escolha = leitor.nextInt();
			System.out.println();
			
			switch(escolha) {
			case 1:
				listarCliente();
				break;
			case 2:
				adicionarCliente();
				break;
			case 3: 
				excluirCliente();
				break;
			case 4:
				modificarCliente();
				break;
			case 5:
				System.out.println("Voltando...");
				continuar = false;
				break;
			default:
				System.out.println("Escolha invalida");
				break;
			}
		}
	}
	
	
	// PRODUTO
	private static void listarProduto() {
		List<Produto> produtos = ProdutoDAO.listProduto();
		
		for(Produto produto : produtos) {
			System.out.println(produto.toString());
		}
	}

	private static void adicionarProduto() {
		Scanner leitor = new Scanner(System.in);
		
		System.out.print("Nome: ");
		String nome = leitor.nextLine();
		
		System.out.print("Descrição: ");
		String descricao = leitor.nextLine();
		
		System.out.print("Valor: R$");
		double valor = leitor.nextDouble();
		
		System.out.print("Quantidade: ");
		int quantidade = leitor.nextInt();
		
		Produto produto = new Produto(nome, descricao, valor, quantidade);
		
		ProdutoDAO.saveProduto(produto);
	}

	private static void excluirProduto() {
		Scanner leitor = new Scanner(System.in);
		
		System.out.print("CODIGO DO PRODUTO: ");
		int codigo = leitor.nextInt();
		
		Produto produto = ProdutoDAO.getProduto(codigo);
		
		System.out.println(produto.toString());
		System.out.print("Deseja excluir(S/N)?  ");
		String resposta = leitor.next();
		
		if(resposta.toCharArray()[0] == 'S' || resposta.toCharArray()[0] == 's') {
			ProdutoDAO.deleteProduto(produto);
		}
		else {
			System.out.println("Nenhum produto foi excluido");
		}
	}

	private static void modificarProduto() {
		Scanner leitor = new Scanner(System.in);
		
		System.out.print("CODIGO DO PRODUTO: ");
		int codigo = leitor.nextInt();
		
		Produto produto = ProdutoDAO.getProduto(codigo);
		
		System.out.println(produto.toString());
		System.out.print("Deseja modificar(S/N)?  ");
		String resposta = leitor.next();
		
		if(resposta.toCharArray()[0] == 'S' || resposta.toCharArray()[0] == 's') {
			
			System.out.print("NOVO NOME: ");
			leitor.nextLine();
			String nome = leitor.nextLine();
			
			System.out.print("NOVA DESCRIÇÃO: ");
			String descricao = leitor.nextLine();
			
			System.out.print("NOVO VALOR: R$");
			double valor = leitor.nextDouble();
			
			System.out.print("NOVO ESTOQUE: ");
			int estoque = leitor.nextInt();
			
			produto.setPRO_NOME(nome);
			produto.setPRO_DESCRICAO(descricao);
			produto.setPRO_VALOR(valor);
			produto.setPRO_ESTOQUE(estoque);
			
			ProdutoDAO.updateProduto(produto);
		}
		else {
			System.out.println("Nenhum produto foi modificado");
			return;
		}
	}

	private static void procurarNomeProduto() {
		Scanner leitor = new Scanner(System.in);
		
		System.out.print("Nome: ");
		String nome = leitor.nextLine();
		
		List<Produto> produtos = ProdutoDAO.listProduto(nome);
		
		for(Produto produto : produtos) {
			System.out.println(produto.toString());
		}
	}
	
	private static void procurarPrecoProduto() {
		Scanner leitor = new Scanner(System.in);
		
		System.out.print("Preco minimo: ");
		double precoMinimo = leitor.nextDouble();
		
		System.out.print("Preco máximo: ");
		double precoMaximo = leitor.nextDouble();
		
		List<Produto> produtos = ProdutoDAO.listProduto(precoMinimo, precoMaximo);
		
		for(Produto produto : produtos) {
			System.out.println(produto.toString());
		}
	}

	// PEDIDO
	private static void listarPedido(){
		List<Pedido> pedidos = PedidoDAO.listPedido();
		
		for(Pedido pedido : pedidos) {
			Venda venda = new Venda(pedido.getPED_CODIGO());
			System.out.println(venda.toString());
		}
	}
	
	private static void adicionarPeidido() {
		Scanner leitor = new Scanner(System.in);
		
		int codigoCliente, codigoProduto;
		int nItens;
		int qtdeProduto;
		
		System.out.println("CODIGO DO CLIENTE: ");
		codigoCliente = leitor.nextInt();
		System.out.println("NUMERO DE ITENS: ");
		nItens = leitor.nextInt();
		
		Date dataAtual = new Date();
		Pedido pedido = new Pedido(codigoCliente, dataAtual);
		PedidoDAO.savePedido(pedido);
		
		for(int i = 0; i < nItens; i++) {
			System.out.println("CODIGO DO PRODUTO: ");
			codigoProduto = leitor.nextInt();
			System.out.println("QUANTIDADE: ");
			qtdeProduto = leitor.nextInt();
			
			ProdutoPedido proPedido = new ProdutoPedido(-1 , codigoProduto, qtdeProduto);
			ProdutoPedidoDAO.saveProdutoPedido(proPedido);
		}
	}
	
	private static void excluirPeidido() {
		// TODO Auto-generated method stub
		
	}
	
	private static void modificarPedido() {
		// TODO Auto-generated method stub
		
	}
	
	// CLIENTE
	private static void listarCliente() {
		List<Cliente> clientes = ClienteDAO.getCliente();
		
		for(Cliente cliente : clientes) {
			System.out.println(cliente.toString());
		}
		
	}

	private static void adicionarCliente() {
		Scanner leitor = new Scanner(System.in);
		
		System.out.print("Nome: ");
		String nome = leitor.nextLine();
		
		System.out.print("Email: ");
		String email = leitor.nextLine();
		
		System.out.print("Endereco: ");
		String endereco = leitor.nextLine();
		
		System.out.print("Telefone: ");
		String telefone= leitor.nextLine();
		
		Cliente cliente = new Cliente(nome, email, endereco, telefone);
		
		ClienteDAO.saveCliente(cliente);
		
	}

	private static void excluirCliente() {
		Scanner leitor = new Scanner(System.in);
		
		System.out.print("CODIGO DO CLIENTE: ");
		int codigo = leitor.nextInt();
		
		Cliente cliente = ClienteDAO.getCliente(codigo);
		
		System.out.println(cliente.toString());
		System.out.print("Deseja excluir(S/N)?  ");
		String resposta = leitor.next();
		
		if(resposta.toCharArray()[0] == 'S' || resposta.toCharArray()[0] == 's') {
			ClienteDAO.deleteCliente(cliente);
		}
		else {
			System.out.println("Nenhum Cliente foi excluido");
		}
		
	}

	private static void modificarCliente() {
		Scanner leitor = new Scanner(System.in);
		
		System.out.print("CODIGO DO CLIENTE: ");
		int codigo = leitor.nextInt();
		
		Cliente cliente= ClienteDAO.getCliente(codigo);
		
		System.out.println(cliente.toString());
		System.out.print("Deseja modificar(S/N)?  ");
		String resposta = leitor.next();
		
		if(resposta.toCharArray()[0] == 'S' || resposta.toCharArray()[0] == 's') {
			
			System.out.print("NOVO NOME: ");
			leitor.nextLine();
			String nome = leitor.nextLine();
			
			System.out.print("NOVA EMAIL: ");
			String email = leitor.nextLine();
			
			System.out.print("NOVO ENDERECO: ");
			String endereco = leitor.nextLine();
			
			System.out.print("NOVO TELEFONE: ");
			String telefone = leitor.nextLine();
			
			cliente.setCLI_NOME(nome);
			cliente.setCLI_EMAIL(email);
			cliente.setCLI_ENDERECO(endereco);
			cliente.setCLI_TELEFONE(telefone);
			
			ClienteDAO.updateCliente(cliente);
		}
		else {
			System.out.println("Nenhum cliente foi modificado");
			return;
		}
		
	}
}